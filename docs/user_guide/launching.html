

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Launching the OLCF Test Harness (OTH) &mdash; NCCS_Test_Harness 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/custom.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adding a New Test to the OTH" href="adding_new_test.html" />
    <link rel="prev" title="Overview of the Test Harness" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #efefef" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/olcf_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of the Test Harness</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#purpose">Purpose</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#execution-overview">Execution Overview</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Launching the OLCF Test Harness (OTH)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#oth-setup">OTH Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#option-1-using-the-centralized-pre-built-oth">Option 1: Using the centralized (pre-built) OTH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#on-lyra">On Lyra</a></li>
<li class="toctree-l4"><a class="reference internal" href="#on-spock">On Spock</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#option-2-using-your-own-copy-of-the-harness">Option 2: Using your own copy of the harness</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#launching-the-oth">Launching the OTH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="adding_new_test.html">Adding a New Test to the OTH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="adding_new_test.html#application-source-code-repository-structure">Application Source Code Repository Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#repository-url">Repository URL</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#repository-structure">Repository structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#example-repository">Example Repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="adding_new_test.html#application-test-input">Application Test Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="adding_new_test.html#required-application-test-scripts">Required Application Test Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#build-script">Build Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#job-script-template">Job Script Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#check-script">Check Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_new_test.html#notes-on-where-things-are">Notes on Where Things Are</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="adding_new_machine.html">Adding a New Machine to the OTH</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/notational_conventions.html">Notational Conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/notational_conventions.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/intro.html#raison-d-etre">Raison d’etre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/intro.html#organizational-structure">Organizational Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/intro.html#prequisites">Prequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/intro.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/unit_test_framework.html">Harness’s Git Unit Test Framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/unit_test_framework.html#organizational-structure">Organizational Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/unit_test_framework.html#setting-up-the-harness-unit-testing-runtime-environment">Setting Up the Harness Unit Testing Runtime Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/unit_test_framework.html#generic-tests">Generic Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/unit_test_framework.html#machine-specific-tests">Machine Specific Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/unit_test_framework.html#running-the-harness-unit-tests">Running the Harness Unit Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/unit_test_framework.html#id1">Generic Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/unit_test_framework.html#id2">Machine Specific Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/unit_test_framework.html#harness-unit-testing-api">Harness Unit Testing API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/unit_test_framework/git_ci_test_framework.html">Usage and Developer Documentation for GitLab CI/CD</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/unit_test_framework/pytest_test_framework.html">Usage and Developer Documentation for Harness’ pytest Unit Tests</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/packages.html">NCCS Harness Python Packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/packages/repositories.html">NCCS Harness repositories package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/packages/repositories.html#intoduction">Intoduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/packages/repositories.html#prerequisite-environmental-variables">Prerequisite Environmental Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/packages/repositories.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/packages/repositories.html#modules">Modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/packages/bin.html">NCCS Harness bin package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/packages/bin.html#intoduction">Intoduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/packages/bin.html#modules">Modules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/modules.html">harness</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NCCS_Test_Harness</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Launching the OLCF Test Harness (OTH)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user_guide/launching.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="launching-the-olcf-test-harness-oth">
<h1>Launching the OLCF Test Harness (OTH)<a class="headerlink" href="#launching-the-olcf-test-harness-oth" title="Permalink to this headline">¶</a></h1>
<p>To launch the OLCF Test Harness (OTH) you must first access the harness code.
This can be done in two ways, one by obtaining your own copy of the code or
using the centralized harness code that will be available on the system under
test.</p>
<section id="oth-setup">
<h2>OTH Setup<a class="headerlink" href="#oth-setup" title="Permalink to this headline">¶</a></h2>
<section id="option-1-using-the-centralized-pre-built-oth">
<h3>Option 1: Using the centralized (pre-built) OTH<a class="headerlink" href="#option-1-using-the-centralized-pre-built-oth" title="Permalink to this headline">¶</a></h3>
<section id="on-lyra">
<h4>On Lyra<a class="headerlink" href="#on-lyra" title="Permalink to this headline">¶</a></h4>
<p>The code is already installed in: <em>/sw/lyra/acceptance/olcf-test-harness</em></p>
<p>Setup the environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">OLCF_HARNESS_DIR</span><span class="o">=</span>/sw/lyra/acceptance/olcf-test-harness
module use <span class="nv">$OLCF_HARNESS_DIR</span>/modulefiles
module load olcf_harness
<span class="nb">export</span> <span class="nv">OLCF_HARNESS_MACHINE</span><span class="o">=</span>lyra
</pre></div>
</div>
</section>
<section id="on-spock">
<h4>On Spock<a class="headerlink" href="#on-spock" title="Permalink to this headline">¶</a></h4>
<p>The code is already installed in: <em>/ccs/proj/stf016/spock_acpt/olcf-test-harness</em></p>
<p>Setup the environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">OLCF_HARNESS_DIR</span><span class="o">=</span>/ccs/proj/stf016/spock_acpt/olcf-test-harness/
module use <span class="nv">$OLCF_HARNESS_DIR</span>/modulefiles
module load olcf_harness
<span class="nb">export</span> <span class="nv">OLCF_HARNESS_MACHINE</span><span class="o">=</span>spock
</pre></div>
</div>
</section>
</section>
<section id="option-2-using-your-own-copy-of-the-harness">
<h3>Option 2: Using your own copy of the harness<a class="headerlink" href="#option-2-using-your-own-copy-of-the-harness" title="Permalink to this headline">¶</a></h3>
<p>Clone the repo on the target system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/olcf/olcf-test-harness.git
</pre></div>
</div>
<p>Setup the environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> olcf-test-harness
<span class="nb">export</span> <span class="nv">OLCF_HARNESS_DIR</span><span class="o">=</span><span class="sb">``</span><span class="nb">pwd</span><span class="sb">``</span>
module use <span class="nv">$OLCF_HARNESS_DIR</span>/modulefiles
module load olcf_harness
<span class="nb">export</span> <span class="nv">OLCF_HARNESS_MACHINE</span><span class="o">=</span>&lt;machine&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must have the &lt;machine&gt;.ini file in a directory searched by your PATH
environment variable for your specified machine. On Spock and Lyra, this
is provided for you in the centralized harness. An example_machine.ini
file is provided in the configs directory.</p>
</div>
</section>
</section>
<section id="launching-the-oth">
<h2>Launching the OTH<a class="headerlink" href="#launching-the-oth" title="Permalink to this headline">¶</a></h2>
<p>Create a directory for your run - this is where you will place input files and
retrieve a copy of OTH log files. No computation will be done here:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir lyra_testshot
<span class="nb">cd</span> lyra_testshot
</pre></div>
</div>
<p>Prepare an input file of tests (e.g., <em>rgt.input.lyra</em>). In the file, set
<code class="docutils literal notranslate"><span class="pre">Path_to_tests</span></code> to the location where you would like application source and
run files to be kept (note that the directory provided must be an existing
directory on a file system visible to the current machine). Next, provide one
or more tests to run in the format <code class="docutils literal notranslate"><span class="pre">Test</span> <span class="pre">=</span> <span class="pre">&lt;app-name&gt;</span> <span class="pre">&lt;test-name&gt;</span></code>. In this
example for Lyra, the application <strong>hello_mpi</strong> is used and we specify two
tests: <strong>c_n001</strong> and <strong>c_n002</strong>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">#  Set the path to the top level of the application directory.                 #</span>
<span class="c1">################################################################################</span>

<span class="nv">Path_to_tests</span> <span class="o">=</span> /some/path/to/my/applications

<span class="nv">Test</span> <span class="o">=</span> hello_mpi c_n001
<span class="nv">Test</span> <span class="o">=</span> hello_mpi c_n002
</pre></div>
</div>
<p>Set a different scratch area for this specific instance of the harness (a
default is set but this lets you change the default):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">RGT_PATH_TO_SSPACE</span><span class="o">=</span>&lt;some path <span class="k">in</span> the file system&gt;/Scratch
</pre></div>
</div>
<p>The latest version of the harness supports command line tasks as well as input
file tasks. If no tasks are provided in the input file, it will use the command
line mode. To launch via the CLI:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>runtests.py --inputfile rgt.input.lyra --mode checkout
runtests.py --inputfile rgt.input.lyra --mode start
runtests.py --inputfile rgt.input.lyra --mode checkout start stop
</pre></div>
</div>
<p>When using the checkout mode, the application source repository will be cloned
to the <em>&lt;Path_to_tests&gt;/&lt;app-name&gt;</em> directory for all the tests, but no tests
will be run.</p>
<p>After using the start mode, results of the most recent test run can be found in
<em>&lt;Path_to_tests&gt;/&lt;app-name&gt;/&lt;test-name&gt;/Run_Archive/latest</em>.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="adding_new_test.html" class="btn btn-neutral float-right" title="Adding a New Test to the OTH" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview of the Test Harness" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>